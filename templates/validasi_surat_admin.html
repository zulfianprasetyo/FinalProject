<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Validasi Surat | Siaran RT Online</title>
    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous" />

    <script src="https://code.jquery.com/jquery-3.7.0.js" integrity="sha256-JlqSTELeR4TLqP0OG9dxM7yDPqX1ox/HfgiSLBj8+kM=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>
    <!-- <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script> -->

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.css" />
    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.js"></script>

    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@300&family=Libre+Baskerville:wght@700&family=Merriweather:ital@1&family=Nunito+Sans:wght@300&family=Roboto+Slab:wght@600&display=swap" rel="stylesheet" />

    <style>
      .navbar {
        font-family: "Roboto Slab", serif;
      }
    </style>

    <script>
      function actionChange(url){
        $('#form-selesai').attr('action', '/validasi_surat/verify/'+url)
      }
    </script>
    {% if pengajuan_surat: %}
    <script>
      $(document).ready(function () {
        $('#tableValSurat').DataTable();
      });
    </script>
    {% endif %}
  </head>

  <body>
    <section>
      <div class="container-fluid">
        <div class="row">
          <div class="navbar col-auto col-md-3 col-xl-2 px-sm-2 px-0 bg-dark">
            <div class="d-flex flex-column align-items-center align-items-sm-start px-3 pt-2 text-white min-vh-100">
              <ul class="nav nav-pills flex-column mb-sm-auto mb-0 align-items-center align-items-sm-start" id="menu">
                <li class="nav-item">
                  <a href="/user" class="nav-link align-middle px-0">
                    <img src="/static/profile_placeholder.png" alt="Gambar Profil" width="30" height="30" class="rounded-circle" />
                    <span class="ms-1 d-none d-sm-inline">RT Website</span>
                  </a>
                </li>

                <li class="nav-item dropdown align-items-center">
                  <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <i class="bi bi-calendar-check fs-4"></i> <span class="ms-1 d-none d-sm-inline">Validasi</span>
                  </a>
                  <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <li><a class="dropdown-item" href="/home_admin">Validasi Registrasi User</a></li>
                    <li><a class="dropdown-item" href="/validasi_surat">Validasi Pengajuan Surat</a></li>
                  </ul>
                </li>

                <li>
                  <a href="/pengumuman"  class="nav-link px-0 align-middle"> <i class="fs-4 bi-megaphone"></i> <span class="ms-1 d-none d-sm-inline">Pengumuman</span></a>
                </li>

                <li>
                  <a href="/sosial" class="nav-link px-0 align-middle"> <i class="fs-4 bi-people"></i> <span class="ms-1 d-none d-sm-inline">Sosial</span> </a>
                </li>

                <li class="nav-item dropdown align-items-center">
                  <a class="nav-link dropdown-toggle" href="#" id="layananDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <i class="fs-4 bi-tools"></i> <span class="ms-1 d-none d-sm-inline">Layanan</span>
                  </a>
                  <ul class="dropdown-menu" aria-labelledby="layananDropdown">
                    <li><a class="dropdown-item" href="/data_warga">Data Warga</a></li>
                    <li><a class="dropdown-item active" href="/pengajuan_surat">Pengajuan Surat</a></li>
                  </ul>
                </li>

                <li>
                  <a href="/about" class="nav-link px-0 align-middle"> <i class="fs-4 bi-info-circle"></i> <span class="ms-1 d-none d-sm-inline">About</span> </a>
                </li>
              </ul>
              <hr class="footer-divider" />
              <div class="d-grid gap-2 mb-2">
                <a href="/logout" class="btn btn-primary"> Logout </a>
              </div>
            </div>
          </div>

          <div class="col">
            <div class="container-fluid mt-2">
              <div class="row align-items-stretch mb-4 rounded">
                <div class="md-8 py-3 order-md-1 text-light" style="background-color: #5893d4">
                  <h3>Selamat Datang di Dashboard Admin, <strong>{{ session.user.username }}</strong></h3>
                </div>
              </div>

              <div class="card p-4 mb-3">
                <div class="row align-items-stretch mb-5">
                  <div class="md-4 py-3 order-md-2">
                    <h1 class="text-center mb-5" style="margin-bottom: 20px">Validasi Pengajuan Surat</h1>

                    <table class="table table-striped" style="margin-top: 30px" id="tableValSurat">
                      <thead>
                        <tr>
                          <th>Jenis Surat</th>
                          <th>Nama Lengkap</th>
                          <th>TTL</th>
                          <th>Jenis Kelamin</th>
                          <th>Alamat</th>
                          <th>Agama</th>
                          <th>No.Hp</th>
                          <th>Aksi</th>
                        </tr>
                      </thead>
                      <tbody>
                        {% for ps in pengajuan_surat %}
                        {% set noHP = ps.nohp %}
                        <tr>
                          <td>{{ ps.jenisSurat }}</td>
                          <td>{{ ps.namaLengkap }}</td>
                          <td>{{ ps.ttl }}</td>
                          <td>{{ ps.jenisKelamin }}</td>
                          <td>{{ ps.alamat }}</td>
                          <td>{{ ps.agama }}</td>
                          <td id="noHP">{{ ps.nohp }}</td>

                          <td>
                            {% if ps.status == 'Pending' %}
                            <a class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#selesaiModal" onclick="actionChange('{{noHP}}')">Selesaikan</a>
                            {% else %} Selesai {% endif %}
                          </td>
                        </tr>                  
                        {% endfor %}
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- modal -->
          <div class="modal fade" id="selesaiModal" tabindex="-1" aria-labelledby="selesaiModalLabel" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="ModalLabel">Submit Surat</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form action="" method="POST" enctype="multipart/form-data" id="form-selesai">
                  <div class="modal-body">
                    <div class="mb-3">
                      <label for="fileSurat" class="form-label text-start">File Surat</label>
                      <input type="file" class="form-control" id="fileSurat" name="fileSurat" />
                    </div>
                    <div class="modal-footer">
                      <input href="" type="submit" class="btn btn-primary" value="Save changes"></input>
                      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>
          <!-- modal -->
        </div>
      </div>
    </section>
    <!-- footer -->
    <footer class="footer py-5 text-center bg-dark text-light">
      <span>&copy; 2023 Group 5, Kelompok 4</span>
    </footer>
    <!-- akhir footer -->
  </body>
</html>
